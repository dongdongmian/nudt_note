---
layout: default
title: git的使用
---
　　<h2>{{ page.title }}</h2>
　　<p>我的第一篇文章</p>
　　<p>{{ page.date | date_to_string }}</p>

## git 的使用
[参考文章0](http://blog.jobbole.com/78960/)

[建议文章0](http://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000)

[TOC]

### 基本入门
#### **基本配置**
`git config --global`：表示这台机器所有的 git 都使用这个配置，如用户名和邮箱

配置名字和邮箱
`git config --global user.name "[your name]"`
`git config --global user.email "[your email]"`

#### **创建版本库**
>`什么是版本库`
>版本库又名仓库，英文名repository,你可以简单的理解一个目录，这个目录里面的所有文件都可以被Git管理起来，每个文件的修改，删除，Git都能跟踪，以便任何时刻都可以追踪历史，或者在将来某个时刻还可以将文件”还原”

新建版本库：
1. 进入到一个需要建立版本库的文件夹内，可以用 `pwd` 命令显示当前的目录

2. 通过 `git init` 将这个文件夹变成 git 可以管理的仓库，这是在文件夹内就会创建一个 .git 的文件夹，用于 git 跟踪管理版本

将文件添加到版本库中：
1. 在版本库中添加文件 eg :  test.txt
2. `git add test.txt`命令将文本文件添加到暂存区中
3. `git commit [-m "[提交的注释]"]`将暂存区中的文件提交到仓库("[]"中的内容是可选的) 
4. `git status` 查看当前是否还有文件未提交/是否有文件进行了修改未提交
5. `git diff [文件名]`查看文件修改的内容，如果需要提交修改后的文件，使用 add 再 commit

<font size=2.5 color=blue>git init -> 在文件夹下创建文本文件或代码 -> git add -> git commit -> git status </font>
<font size=2.5 color=blue>修改文件 -> git status -> git diff -> git add -> git commit -> git status</font>

#### **版本回退**
1. `git log`查看提交的历史记录 `git log --pretty=oneline`简洁显示
2. `git reset --hard HEAD^`回退到上一个版本 `git reset --hard HEAD^^`回退到上上个版本  `git reset --hard HEAD~100` 回退到前100个版本  查看内容可以用命令`cat [filename]`
3. `git reflog`获取已经被回退的版本号   `git reset --hard [版本号]`恢复已经被回退的内容

#### **理解工作区和暂存区**
>**`工作区`** 在电脑上看到的目录，除 .git 文件夹外
>**`版本库(Repository)`** .git 文件夹不属于工作区，而是作为版本库。其中在暂存区是 (stage)，git 为我们创建了第一个分支 master ，还有一个指向 master 的指针 HEAD ，HEAD 中的内容是 `ref: refs/heads/master` 

#### **撤销修改**
文件 add 后，未提交之前：
1. 如果知道需要修改的内容，直接在文件中进行修改，然后 add ，commit
2. 可以恢复到以前的版本
3. `git checkout -- [filename]`这个命令撤销的是在 add 之后修改的内容

#### **删除文件**
1. 直接在文件夹下删除文件，或者使用命令`rm [filename]`来删除。之后再使用命令`git commit`从版本库中彻底删除文件
2. 如果没有使用 commit 彻底删除，想要重新恢复的话，使用命令`git checkout -- [filename]`

#### **远程仓库**
在 git 仓库和 github 仓库中进行文件的上传和下载，他们之间的传输时通过 SSH 加密的

创建 SSH KEY
1. 在用户主目录下，看看有没有.ssh目录，如果有，再看看这个目录下有没有id_rsa和id_rsa.pub这两个文件，如果有的话，直接跳过此如下命令
2. `ssh-keygen  -t rsa –C "[youremail@example.com]"`根据提示完成即可
3. 登录 github ，打开  settings 中的SSH Keys页面，然后点击 "Add SSH Key" ，填上任意 title，在Key 文本框里黏贴 id_rsa.pub 文件的内容

添加远程仓库
>我们已经在本地创建了一个Git仓库后，又想在github创建一个Git仓库，并且希望这两个仓库进行远程同步，这样github的仓库可以作为备份，又可以其他人通过该仓库来协作。

1. 在 github 中添加一个新的仓库，不需要添加默认的 readme ，不然还需要将这个 readme 同步到本地
2. `git remote add origin [新建的仓库地址]`这个命令是选定将要上传的地址
3. `git push -u origin [分支，一般为master]`将当前分支 master 推送到远程 master 分支上，并将本地 master 分支和远程 master 分支关联起来，以后的推送可以简化命令 `git push origin master`

从远程库克隆到本地`git clone [远程库的地址]`

#### **创建与合并分支**
1. `git checkout -b [brachname]`创建分支并切换到分支上 <font color=orange>**=**</font> `git branch dev`创建  `+`  `git checkout dev`转到分支 
`git branch`查看分支
2. `git merge [branchname]`合并分支到当前分支
3. 合并完成之后就可以删除相应的分支了 `git branch -d [branchname]`

**解决合并冲突**
可以使用 `git status`查看当前冲突的代码，然后再根据具体的情况修改文件
`cat [fileName]`查看冲突文件中的冲突内容，修改
`git log`查看分支的合并情况

**分支管理策略**
由于我们合并分支的时候采用的一般为 "Fast forword" 模式，这种模式下如果我们删除分支就会丢失分支的信息，这时可以采用参数 `--no-ff`禁用  "Fast forword" 模式

**bug 分支**
当开发过程中有 bug 的时候，可以通过创建一个临时 bug 分支来修复 bug ，当 bug 修复完成以后再合并到相应分支中

比如分支 dev 中出现了 bug，但是此时的 dev 分支中的工作没有完成，无法进行提交 commit ，那么此时我们可以先将当前工作现场隐藏起来，等修复 bug 后继续工作
>1. `git stash` 隐藏当前的工作现场
>2. 创建一个临时的 bug 分支
>3. 将 bug 分支合并到相应的分支中后删除 bug 分支
>4. 回到 dev 分支工作，使用`git stash list`查看工作现场
>5. 恢复 stash 中的内容
	>`git stash apply`恢复 + `git stash drop`删除  = `git stash pop`

#### **多人协作**
当你从远程库克隆时候，实际上Git自动把本地的master分支和远程的master分支对应起来了，并且远程库的默认名称是origin

要查看远程库的信息 使用 `git remote`要查看远程库的详细信息 使用 `git remote –v`

**推送分支**
`git push origin [本地指定推送分支]`将指定分支推送到远程库中

master 是主分支，所以应该时刻保持着与远程分支的同步
修复的 bug 分支，可以先合并到主分支上，然后把主分支 master 推送到远程中

**抓取分支**
克隆远程的库到本地
加入在库中有分支 dev ，大家都在该分支上进行修改和推送

`git checkout  –b dev origin/dev`将远程分支 dev 拷贝到本地的 dev 分支中，然后再该分支进行开发，开发完成后将 dev 分支推送到远程

而当有其他的人也在试图将修改推送到同一个分支的时候，可能会因为修改的内容不同而导致`冲突`，此时我们先将远程的分支 `git pull`到本地，然后在本地合并解决冲突后，再推送

**总结**
>1. 首先，可以试图用git push origin branch-name推送自己的修改.
>2. 如果推送失败，则因为远程分支比你的本地更新早，需要先用git pull试图合并。
>3. 如果合并有冲突，则需要解决冲突，并在本地提交。再用git push origin branch-name推送

**大自然的搬运工**
```
  mkdir：         XX (创建一个空目录 XX指目录名)
   pwd：          显示当前目录的路径。
   git init          把当前的目录变成可以管理的git仓库，生成隐藏.git文件。
   git add XX       把xx文件添加到暂存区去。
   git commit –m “XX”  提交文件 –m 后面的是注释。
   git status        查看仓库状态
   git diff  XX      查看XX文件修改了那些内容
   git log          查看历史记录
   git reset  –hard HEAD^ 或者 git reset  –hard HEAD~ 回退到上一个版本(如果想回退到100个版本，使用git reset –hard HEAD~100 )
   cat XX         查看XX文件内容
   git reflog       查看历史记录的版本号id
   git checkout — XX  把XX文件在工作区的修改全部撤销。
   git rm XX          删除XX文件
   git remote add origin https://github.com/tugenhua0707/testgit 关联一个远程库
   git push –u(第一次要用-u 以后不需要) origin master 把当前master分支推送到远程库
   git clone https://github.com/tugenhua0707/testgit  从远程库中克隆
   git checkout –b dev  创建dev分支 并切换到dev分支上
   git branch  查看当前所有的分支
   git checkout master 切换回master分支
   git merge dev    在当前的分支上合并dev分支
   git branch –d dev 删除dev分支
   git branch name  创建分支
   git stash 把当前的工作隐藏起来 等以后恢复现场后继续工作
   git stash list 查看所有被隐藏的文件列表
   git stash apply 恢复被隐藏的文件，但是内容不删除
   git stash drop 删除文件
   git stash pop 恢复文件的同时 也删除文件
   git remote 查看远程库的信息
   git remote –v 查看远程库的详细信息
   git push origin master  Git会把master分支推送到远程库对应的远程分支上
```